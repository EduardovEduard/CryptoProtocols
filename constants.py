__author__ = 'ees'

import numpy as np

IV = np.array([0, 0, 0, 0, 0, 0, 0, 1] * 64)  # Инициализационный вектор функции хеширования

# Значения подстановки Pi'
PI_PERM = np.array([252, 238, 221, 17, 207, 110, 49, 22,
                    251, 196, 250, 218, 35, 197, 4, 77, 233,
                    119, 240, 219, 147, 46, 153, 186, 23, 54,
                    241, 187, 20, 205, 95, 193, 249, 24, 101,
                    90, 226, 92, 239, 33, 129, 28, 60, 66, 139,
                    1, 142, 79, 5, 132, 2, 174, 227, 106, 143, 160,
                    6, 11, 237, 152, 127, 212, 211, 31, 235, 52, 44,
                    81, 234, 200, 72, 171, 242, 42, 104, 162, 253, 58,
                    206, 204, 181, 112, 14, 86, 8, 12, 118, 18, 191,
                    114, 19, 71, 156, 183, 93, 135, 21, 161, 150, 41,
                    16, 123, 154, 199, 243, 145, 120, 111, 157, 158,
                    178, 177, 50, 117, 25, 61, 255, 53, 138, 126, 109,
                    84, 198, 128, 195, 189, 13, 87, 223, 245, 36, 169,
                    62, 168, 67, 201, 215, 121, 214, 246, 124, 34, 185,
                    3, 224, 15, 236, 222, 122, 148, 176, 188, 220, 232,
                    40, 80, 78, 51, 10, 74, 167, 151, 96, 115, 30, 0, 98,
                    68, 26, 184, 56, 130, 100, 159, 38, 65, 173, 69, 70,
                    146, 39, 94, 85, 47, 140, 163, 165, 125, 105, 213,
                    149, 59, 7, 88, 179, 64, 134, 172, 29, 247, 48, 55,
                    107, 228, 136, 217, 231, 137, 225, 27, 131, 73, 76,
                    63, 248, 254, 141, 83, 170, 144, 202, 216, 133, 97,
                    32, 113, 103, 164, 45, 43, 9, 91, 203, 155, 37, 208,
                    190, 229, 108, 82, 89, 166, 116, 210, 230, 244, 180,
                    192, 209, 102, 175, 194, 57, 75, 99, 182])

# Перестановка байт
TAU = np.array([0, 8, 16, 24, 32, 40, 48, 56, 1, 9, 17, 25, 33, 41, 49,
                57, 2, 10, 18, 26, 34, 42, 50, 58, 3, 11, 19, 27, 35,
                43, 51, 59, 4, 12, 20, 28, 36, 44, 52, 60, 5, 13, 21,
                29, 37, 45, 53, 61, 6, 14, 22, 30, 38, 46, 54, 62, 7,
                15, 23, 31, 39, 47, 55, 63])

A_list = ['8e20faa72ba0b470', '47107ddd9b505a38', 'ad08b0e0c3282d1c', 'd8045870ef14980e',
          '6c022c38f90a4c07', '3601161cf205268d', '1b8e0b0e798c13c8', '83478b07b2468764',
          'a011d380818e8f40', '5086e740ce47c920', '2843fd2067adea10', '14aff010bdd87508',
          '0ad97808d06cb404', '05e23c0468365a02', '8c711e02341b2d01', '46b60f011a83988e',
          '90dab52a387ae76f', '486dd4151c3dfdb9', '24b86a840e90f0d2', '125c354207487869',
          '092e94218d243cba', '8a174a9ec8121e5d', '4585254f64090fa0', 'accc9ca9328a8950',
          '9d4df05d5f661451', 'c0a878a0a1330aa6', '60543c50de970553', '302a1e286fc58ca7',
          '18150f14b9ec46dd', '0c84890ad27623e0', '0642ca05693b9f70', '0321658cba93c138',
          '86275df09ce8aaa8', '439da0784e745554', 'afc0503c273aa42a', 'd960281e9d1d5215',
          'e230140fc0802984', '71180a8960409a42', 'b60c05ca30204d21', '5b068c651810a89e',
          '456c34887a3805b9', 'ac361a443d1c8cd2', '561b0d22900e4669', '2b838811480723ba',
          '9bcf4486248d9f5d', 'c3e9224312c8c1a0', 'effa11af0964ee50', 'f97d86d98a327728',
          'e4fa2054a80b329c', '727d102a548b194e', '39b008152acb8227', '9258048415eb419d',
          '492c024284fbaec0', 'aa16012142f35760', '550b8e9e21f7a530', 'a48b474f9ef5dc18',
          '70a6a56e2440598e', '3853dc371220a247', '1ca76e95091051ad', '0edd37c48a08a6d8',
          '07e095624504536c', '8d70c431ac02a736', 'c83862965601dd1b', '641c314b2b8ee083']


C = [
    [11, 1, 0, 8, 5, 11, 13, 10, 1, 14, 12, 10, 13, 10, 14, 9, 14, 11, 12, 11, 2,
     15, 8, 1, 12, 0, 6, 5, 7, 12, 1, 15, 2, 15, 6, 10, 7, 6, 4, 3, 2, 14, 4, 5,
     13, 0, 1, 6, 7, 1, 4, 14, 11, 8, 8, 13, 7, 5, 8, 5, 12, 4, 15, 12, 4, 11, 7,
     12, 14, 0, 9, 1, 9, 2, 6, 7, 6, 9, 0, 1, 10, 2, 4, 2, 2, 10, 0, 8, 10, 4, 6,
     0, 13, 3, 1, 5, 0, 5, 7, 6, 7, 4, 3, 6, 12, 12, 7, 4, 4, 13, 2, 3, 13, 13, 8,
     0, 6, 5, 5, 9, 15, 2, 10, 6, 4, 5, 0, 7],
    [6, 15, 10, 3, 11, 5, 8, 10, 10, 9, 9, 13, 2, 15, 1, 10, 4, 15, 14, 3, 9, 13,
     4, 6, 0, 15, 7, 0, 11, 5, 13, 7, 15, 3, 15, 14, 14, 10, 7, 2, 0, 10, 2, 3, 2,
     11, 9, 8, 6, 1, 13, 5, 5, 14, 0, 15, 1, 6, 11, 5, 0, 1, 3, 1, 9, 10, 11, 5, 1,
     7, 6, 11, 1, 2, 13, 6, 9, 9, 5, 8, 5, 12, 11, 5, 6, 1, 12, 2, 13, 11, 0, 10,
     10, 7, 12, 10, 5, 5, 13, 13, 10, 2, 1, 11, 13, 7, 12, 11, 12, 13, 5, 6, 14, 6,
     7, 9, 0, 4, 7, 0, 2, 1, 11, 1, 9, 11, 11, 7],
    [15, 5, 7, 4, 13, 12, 10, 12, 2, 11, 12, 14, 2, 15, 12, 7, 0, 10, 3, 9, 15,
     12, 2, 8, 6, 10, 3, 13, 8, 4, 3, 5, 0, 6, 15, 1, 5, 14, 5, 15, 5, 2, 9, 12,
     1, 15, 8, 11, 15, 2, 14, 10, 7, 5, 1, 4, 11, 1, 2, 9, 7, 11, 7, 11, 13, 3, 14,
     2, 0, 15, 14, 4, 9, 0, 3, 5, 9, 14, 11, 1, 12, 1, 12, 9, 3, 10, 3, 7, 6, 0, 6,
     2, 13, 11, 0, 9, 12, 2, 11, 6, 15, 4, 4, 3, 8, 6, 7, 10, 13, 11, 3, 1, 9, 9,
     1, 14, 9, 6, 15, 5, 0, 10, 11, 10, 0, 10, 11, 2],
    [14, 15, 1, 15, 13, 15, 11, 3, 14, 8, 1, 5, 6, 6, 13, 2, 15, 9, 4, 8, 14, 1,
     10, 0, 5, 13, 7, 1, 14, 4, 13, 13, 4, 8, 8, 14, 8, 5, 7, 14, 3, 3, 5, 12, 3,
     12, 7, 13, 9, 13, 7, 2, 1, 12, 10, 13, 6, 8, 5, 14, 3, 5, 3, 15, 10, 9, 13, 7,
     2, 12, 8, 2, 14, 13, 0, 3, 13, 6, 7, 5, 13, 8, 11, 7, 1, 3, 3, 3, 9, 3, 5, 2,
     0, 3, 11, 14, 3, 4, 5, 3, 14, 10, 10, 1, 9, 3, 14, 8, 3, 7, 15, 1, 2, 2, 0,
     12, 11, 14, 11, 12, 8, 4, 14, 3, 13, 1, 2, 14],
    [4, 11, 14, 10, 6, 11, 10, 12, 10, 13, 4, 7, 4, 7, 9, 9, 9, 10, 3, 15, 4, 1,
     0, 12, 6, 12, 10, 9, 2, 3, 6, 3, 7, 15, 1, 5, 1, 12, 1, 15, 1, 6, 8, 6, 1, 0,
     4, 10, 3, 5, 9, 14, 3, 5, 13, 7, 8, 0, 0, 15, 15, 15, 11, 13, 11, 15, 12, 13,
     1, 7, 4, 7, 2, 5, 3, 10, 15, 5, 10, 3, 13, 15, 15, 15, 0, 0, 11, 7, 2, 3, 2,
     7, 1, 10, 1, 6, 7, 10, 5, 6, 10, 2, 7, 14, 10, 9, 14, 10, 6, 3, 15, 5, 6, 0,
     1, 7, 5, 8, 15, 13, 7, 12, 6, 12, 15, 14, 5, 7],
    [10, 14, 4, 15, 10, 14, 10, 14, 1, 13, 3, 10, 13, 3, 13, 9, 6, 15, 10, 4, 12,
     3, 3, 11, 7, 10, 3, 0, 3, 9, 12, 0, 2, 13, 6, 6, 12, 4, 15, 9, 5, 1, 4, 2, 10,
     4, 6, 12, 1, 8, 7, 15, 9, 10, 11, 4, 9, 10, 15, 0, 8, 14, 12, 6, 12, 15, 15,
     10, 10, 6, 11, 7, 1, 12, 9, 10, 11, 7, 11, 4, 0, 10, 15, 2, 1, 15, 6, 6, 12,
     2, 11, 14, 12, 6, 11, 6, 11, 15, 7, 1, 12, 5, 7, 2, 3, 6, 9, 0, 4, 15, 3, 5,
     15, 10, 6, 8, 4, 0, 7, 10, 4, 6, 6, 4, 7, 13, 6, 14],
    [15, 4, 12, 7, 0, 14, 1, 6, 14, 14, 10, 10, 12, 5, 14, 12, 5, 1, 10, 12, 8,
     6, 15, 14, 11, 15, 2, 4, 0, 9, 5, 4, 3, 9, 9, 14, 12, 6, 12, 7, 14, 6, 11,
     15, 8, 7, 12, 9, 13, 3, 4, 7, 3, 14, 3, 3, 1, 9, 7, 10, 9, 3, 12, 9, 0, 9, 9,
     2, 10, 11, 12, 5, 2, 13, 8, 2, 2, 12, 3, 7, 0, 6, 4, 7, 6, 9, 8, 3, 2, 8, 4,
     10, 0, 5, 0, 4, 3, 5, 1, 7, 4, 5, 4, 12, 10, 2, 3, 12, 4, 10, 15, 3, 8, 8, 8,
     6, 5, 6, 4, 13, 3, 10, 1, 4, 13, 4, 9, 3],
    [9, 11, 1, 15, 5, 11, 4, 2, 4, 13, 9, 3, 12, 9, 10, 7, 0, 3, 14, 7, 10, 10, 0,
     2, 0, 12, 6, 14, 4, 1, 4, 1, 4, 14, 11, 7, 15, 8, 7, 1, 9, 12, 3, 6, 13, 14,
     1, 14, 8, 9, 11, 4, 4, 4, 3, 11, 4, 13, 13, 11, 12, 4, 9, 10, 15, 4, 8, 9, 2,
     11, 12, 11, 9, 2, 9, 11, 0, 6, 9, 0, 6, 9, 13, 1, 8, 13, 2, 11, 13, 1, 10, 5,
     12, 4, 2, 15, 3, 6, 10, 12, 12, 2, 3, 5, 5, 9, 5, 1, 10, 8, 13, 9, 10, 4, 7,
     15, 0, 13, 13, 4, 11, 15, 0, 2, 14, 7, 1, 14],
    [3, 7, 8, 15, 5, 10, 5, 4, 1, 6, 3, 1, 2, 2, 9, 11, 9, 4, 4, 12, 9, 10, 13,
     8, 14, 12, 1, 6, 5, 15, 13, 14, 3, 10, 7, 13, 3, 10, 1, 11, 2, 5, 8, 9, 4, 2,
     2, 4, 3, 12, 13, 9, 5, 5, 11, 7, 14, 0, 0, 13, 0, 9, 8, 4, 8, 0, 0, 10, 4, 4,
     0, 11, 13, 11, 11, 2, 12, 14, 11, 1, 7, 11, 2, 11, 8, 10, 9, 10, 10, 6, 0, 7,
     9, 12, 5, 4, 0, 14, 3, 8, 13, 12, 9, 2, 12, 11, 1, 15, 2, 10, 6, 0, 7, 2, 6,
     1, 4, 4, 5, 1, 8, 3, 2, 3, 5, 10, 13, 11],
    [10, 11, 11, 14, 13, 14, 10, 6, 8, 0, 0, 5, 6, 15, 5, 2, 3, 8, 2, 10, 14, 5,
     4, 8, 11, 2, 14, 4, 15, 3, 15, 3, 8, 9, 4, 1, 14, 7, 1, 12, 15, 15, 8, 10, 7,
     8, 13, 11, 1, 15, 15, 15, 14, 1, 8, 10, 1, 11, 3, 3, 6, 1, 0, 3, 9, 15, 14, 7,
     6, 7, 0, 2, 10, 15, 6, 9, 3, 3, 4, 11, 7, 10, 1, 14, 6, 12, 3, 0, 3, 11, 7, 6,
     5, 2, 15, 4, 3, 6, 9, 8, 15, 10, 13, 1, 1, 5, 3, 11, 11, 6, 12, 3, 7, 4, 11,
     4, 12, 7, 15, 11, 9, 8, 4, 5, 9, 12, 14, 13],
    [7, 11, 12, 13, 9, 14, 13, 0, 14, 15, 12, 8, 8, 9, 15, 11, 3, 0, 0, 2, 12, 6,
     12, 13, 6, 3, 5, 10, 15, 14, 9, 4, 13, 8, 15, 10, 6, 11, 11, 11, 14, 11, 10,
     11, 0, 7, 6, 1, 2, 0, 0, 1, 8, 0, 2, 1, 1, 4, 8, 4, 6, 6, 7, 9, 8, 10, 1, 13,
     7, 1, 14, 15, 14, 10, 4, 8, 11, 9, 12, 10, 14, 15, 11, 10, 12, 13, 1, 13, 7,
     13, 4, 7, 6, 14, 9, 8, 13, 14, 10, 2, 5, 9, 4, 10, 12, 0, 6, 15, 13, 8, 5, 13,
     6, 11, 12, 10, 10, 4, 12, 13, 8, 1, 15, 3, 2, 13, 1, 11],
    [3, 7, 8, 14, 14, 7, 6, 7, 15, 1, 1, 6, 3, 1, 11, 10, 13, 2, 1, 3, 8, 0, 11,
     0, 0, 4, 4, 9, 11, 1, 7, 10, 12, 13, 10, 4, 3, 12, 3, 2, 11, 12, 13, 15, 1,
     13, 7, 7, 15, 8, 2, 0, 1, 2, 13, 4, 3, 0, 2, 1, 9, 15, 9, 11, 5, 13, 8, 0, 14,
     15, 9, 13, 1, 8, 9, 1, 12, 12, 8, 6, 14, 7, 1, 13, 10, 4, 10, 10, 8, 8, 14, 1,
     2, 8, 5, 2, 15, 10, 15, 4, 1, 7, 13, 5, 13, 9, 11, 2, 1, 11, 9, 9, 4, 8, 11,
     12, 9, 2, 4, 10, 15, 1, 1, 11, 13, 7, 2, 0],
]

C_i = []
for c in C:
    result = ''
    for byte in c:
        result += bin(byte)[2:].rjust(4, '0')
    C_i.append(np.array([int(bit) for bit in result]))

C = C_i
